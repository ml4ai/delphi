#!/bin/bash

# Author: Joseph Astier

# Create an experiment using the CauseMos 3.0.0 API
#

# Model ID, e.g. "XYZ"
modelId=$1

# Experiment definition file
filename=$2

if [[ $modelId == "" ]] || [[ $filename == "" ]]; then

	echo "Please specify a model ID and a filename"
	echo "Usage:  $0 model_ID filename"

else
	login="-u me:ivilab4fun"
	url=$(./get_delphi_url)
	endpoint="/models/$modelId/experiments"
	call="curl -s $login -X POST $url$endpoint -d @$filename"

	response=$($call)
	experimentId= echo $response | jq -r '.experimentId'

	# show results
	echo $experimentId
fi
